# การทดลองที่ 7 เรื่อง การเขียนโปรแกรมตรวจวัดแสงเพื่อควบคุมการเปิด-ปิดไฟ

## วัตถุประสงค์
1.เพื่อนำสิ่งที่ได้ศึกษามาประยุกต์ใช้

2.เพื่อเข้าใจคำสั่งต่างๆในการเขียนโปรแกรม

3.เพื่อศึกษาเกี่ยวกับการเขียนโปรแกรมเพื่อรันบนไมโครคอนโทรเลอร์

## อุปกรณ์ที่ใช้
1.สาย USB

2.คอมพิวเตอร์

3.serial port

4.ไมโครคอนโทรลเลอร์ (Arduino)

5.sensor แสง

6.adapter

## ศึกษาข้อมูลเบื้องต้น

 * ข้อมูลเกี่ยวกับ sensor แสง : https://th.element14.com/sensor-optical-light-sensor-technology
 
 * คลิปวิดีโอ LAB 
    - 04 run example 4 https://youtu.be/nFqoZT26U5k

 * souce code : https://github.com/choompol-boonmee/lab63b/tree/master/examples

 * https://www.myarduino.net/article/210/%E0%B8%AA%E0%B8%AD%E0%B8%99%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%87%E0%B8%B2%E0%B8%99-arduino-%E0%B9%80%E0%B8%8B%E0%B9%87%E0%B8%99%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%A7%E0%B9%88%E0%B8%B2%E0%B8%87%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%82%E0%B9%89%E0%B8%A1%E0%B9%81%E0%B8%AA%E0%B8%87-%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%84%E0%B8%9F%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B9%81%E0%B8%AA%E0%B8%87

 * https://th.howtodogood.com/16442-Auotmatic-Street-lights-control-using-LDR-and-Ardu-51#menu-2

## วิธีการทำการทดลอง 

1.นำไมโครคอนโทรลเลอร์ต่อกับ serial port โดยผ่าน adapter

2.ต่อ sensor แสงและไฟบ้านเข้ากับ adapter 

3.เขียนโปรแกรมดังนี้

```
#include <Arduino.h>
#include <ESP8266WiFi.h>

int sensorPin = 5; // เลือกพิน input สำหรับ LDR
int val = 0; // แปรผันเพื่อเก็บค่าที่มาจากเซ็นเซอร์
int led = 3;

void setup()
{
	Serial.begin(115200);
	pinMode(3, OUTPUT);
	Serial.println("\n\n\n");
}

void loop()
{
  int val = analogRead(sensorPin);
  Serial.print("val = "); // พิมพ์ข้อความส่งเข้าคอมพิวเตอร์ "val = "
  Serial.println(val); // พิมพ์ค่าของตัวแปร val
	if(val<400) {
    digitalWrite(3, HIGH);
	}
  else {
		digitalWrite(3, LOW);
	}
	delay(100);
}
```

4.upload โปรแกรมเข้าไปที่ไมโครคอนโทรลเลอร์โดยในขณะที่รันจะกดปุ่มดำเพื่อให้ไมโครคอนโทรลเลอร์รับคำสั่งและกดปุ่มสีแดงเพื่อ reset

5.หลังจาก upload เรียบร้อยจะใช้คำสั่ง pio device monitor เพื่อดูผลลัพธ์ที่แสดงผลออกมา

## การบันทึกผลการทดลอง
เมื่อมีปริมาณแสงน้อยกว่าที่กำหนดจะทำการเปิดไฟโดยอัตโนมัติโดยในที่นี้กำหนดไว้ที่ 500 แต่หากมีแสงมากว่า 500 ไฟจะไม่ติด

## อภิปรายผลการทดลอง
เนื่องจากการทดลองนี้ไม่สามารถนำโค้ดไปรันโปรแกรมได้อาจจะทำให้โค้ดใช้ไม่ได้และอาจจะมีปัจจัยอื่นๆทำให้ไม่สามารถนำไปใช้งานได้จริงได้ 

## คำถามหลังการทดลอง
หากการทดลองนี้ใช้ได้จริง โปรแกรมนี้จะมีประโยชน์อย่างไร ?
  > ช่วยลดอุบัติเหตุต่าง ๆ ที่อาจจะเกิดขึ้นได้ เช่น การเดินขึ้นลงบันได การเดินในเวลากลางคืน เป็นต้น
  

